"use strict";(self.webpackChunkdocusaurus_site=self.webpackChunkdocusaurus_site||[]).push([[520],{5960:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>r,contentTitle:()=>s,default:()=>g,frontMatter:()=>a,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"customui","title":"CustomUI","description":"CustomUI implements embedded Excel ribbon with advanced customisation. It also overrides any existing ribbon entirely.","source":"@site/docs/customui.md","sourceDirName":".","slug":"/customui","permalink":"/msexcel/customui","draft":false,"unlisted":false,"editUrl":"https://github.dev/therepos/msexcel/edit/main/docs/customui.md","tags":[],"version":"current","lastUpdatedAt":1756575415000,"frontMatter":{},"sidebar":"docSidebar","previous":{"title":"Custom Functions","permalink":"/msexcel/customfunctions"}}');var o=t(4848),l=t(8453);const a={},s="CustomUI",r={},c=[{value:"Documentation",id:"documentation",level:2},{value:"Implementation",id:"implementation",level:3},{value:"OnLoad",id:"onload",level:3},{value:"GetVisible",id:"getvisible",level:3},{value:"OnAction",id:"onaction",level:3},{value:"GetSelectedItemID",id:"getselecteditemid",level:3},{value:"GetLabel",id:"getlabel",level:3},{value:"Gallery",id:"gallery",level:2},{value:"Resources",id:"resources",level:2}];function m(e){const n={a:"a",br:"br",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",img:"img",li:"li",p:"p",pre:"pre",ul:"ul",...(0,l.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.header,{children:(0,o.jsx)(n.h1,{id:"customui",children:"CustomUI"})}),"\n",(0,o.jsx)(n.p,{children:"CustomUI implements embedded Excel ribbon with advanced customisation. It also overrides any existing ribbon entirely."}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.a,{href:"https://support.microsoft.com/en-us/office/add-or-remove-add-ins-in-excel-0af570c4-5cf3-4fa9-9b88-403625a0b460#:~:text=COM%20add%2Din-,Click%20the%20File%20tab%2C%20click%20Options%2C%20and%20then%20click%20the,install%2C%20and%20then%20click%20OK.",children:"Install"})," Excel addins .xlam file ",(0,o.jsx)(n.a,{href:"https://github.com/therepos/msexcel/blob/main/apps/xlam/customui-example.xlam",children:"CustomUI Example"}),"."]}),"\n",(0,o.jsxs)(n.li,{children:["Read/Write embedded XML file with ",(0,o.jsx)(n.a,{href:"https://github.com/fernandreu/office-ribbonx-editor",children:"Office RibbonX Editor"}),"."]}),"\n"]}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.img,{alt:"Features",src:t(7631).A+"",width:"1391",height:"208"})}),"\n",(0,o.jsx)(n.h2,{id:"documentation",children:"Documentation"}),"\n",(0,o.jsxs)(n.p,{children:["The following examples are based on ",(0,o.jsx)(n.a,{href:"https://github.com/therepos/msexcel/blob/main/apps/xlam/customui-sample.xlam",children:"CustomUI Sample"})," to illustrate the concept.",(0,o.jsx)(n.br,{}),"\n","See official Microsoft ",(0,o.jsx)(n.a,{href:"https://docs.microsoft.com/en-us/office/dev/add-ins/excel/excel-add-ins-overview",children:"documentation"})," for more details."]}),"\n",(0,o.jsx)(n.h3,{id:"implementation",children:"Implementation"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-plain",metastring:'title="Minimum setup for a customUI add-in"',children:"MsExcel.xlam\n\u251c\u2500\u2500 VBA Modules\n\u2502   \u251c\u2500\u2500 Controls    # vba functions of each button\n\u2502   \u2514\u2500\u2500 Ribbon      # vba controls the ribbon\n\u2514\u2500\u2500 CustomUI        # xml displays the ribbon\n"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-vba",metastring:'title="VBA Controls Module"',children:'Sub WorkbookArial(control As IRibbonControl)\n  \n    On Error GoTo ErrorHandler\n    \n    Dim ws As Worksheet\n    Dim sourceSheet As Worksheet\n    Set sourceSheet = ActiveSheet\n    \n    Application.ScreenUpdating = False\n    For Each ws In Worksheets\n         With ws\n            If Not ws.ProtectContents Then\n                .Cells.Font.Name = "Arial"\n                .Cells.Font.Size = 8\n            End If\n         End With\n    Next ws\n    \n    For Each ws In Worksheets\n        If Not ws.ProtectContents Then\n            ws.Activate\n            ActiveWindow.Zoom = 100\n        End If\n    Next\n    Application.ScreenUpdating = True\n    \n    Call sourceSheet.Activate\n    \nErrorHandler:\n    Exit Sub\n    \nEnd Sub\n'})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-vba",metastring:'title="VBA Ribbon Module"',children:'Public Ribbon As IRibbonUI\nPublic MySelectedTabTag As String\nPublic MySelectedGroupTag As String\n\nSub RibbonOnLoad(Rib As IRibbonUI)\n    Set Ribbon = Rib\n    MySelectedTabTag = "t1"\n    MySelectedGroupTag = "t1g1"\n    \nEnd Sub\n'})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-xml",metastring:'title="CustomUI"',children:'\x3c!-- XML --\x3e\n<customUI xmlns="http://schemas.microsoft.com/office/2009/07/customui" onLoad="RibbonOnLoad">\n    <ribbon>\n        <tabs>\n            \x3c!-- Tab --\x3e \n            <tab id="t1" tag="t1" label="TabLabel">\n                \x3c!-- Group --\x3e\n                <group id="t1g1" tag="t1g1" label="Workbook" autoScale="false">   \n                    \x3c!-- Box is a layout container in a group --\x3e \n                    <box id="t1g1x1" boxStyle="horizontal">                                           \n                        \x3c!-- Button --\x3e \n                        <button id="t1g1b1" label="Arial 8" size="large" onAction="WorkbookArial" imageMso="CharacterBorder" />   \n                    </box>                                                                \n                </group>                                                \n            </tab>                                   \n        </tabs>\n    </ribbon>\n</customUI>\n'})}),"\n",(0,o.jsx)(n.h3,{id:"onload",children:"OnLoad"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-xml",metastring:'title="Initialise state of controls on load"',children:'\x3c!-- XML --\x3e\n<customUI xmlns="http://schemas.microsoft.com/office/2009/07/customui" \n            onLoad="RibbonOnLoad">\n'})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-vb",metastring:'title="Declare global variables and object"',children:"Public Ribbon As IRibbonUI\nPublic MySelectedTabTag As String\nPublic MySelectedGroupTag As String\nPublic MySelectedItemID As String\n"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-vb",metastring:'title="Initialise the ribbon"',children:'Sub RibbonOnLoad(Rib As IRibbonUI)\n\n    Set Ribbon = Rib\n    MySelectedTabTag = "tb1"\n    MySelectedGroupTag = "tb1gp2"\n    MySelectedItemID = "tb2gp2dd1_01"\n    \nEnd Sub\n'})}),"\n",(0,o.jsx)(n.h3,{id:"getvisible",children:"GetVisible"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-xml",metastring:'title="Generate visible attribute of tab control, dynamically"',children:'\x3c!-- XML --\x3e\n<tab id="tb1" \n    tag="tb1" \n    label="Tab 1" \n    getVisible="ShowTab">\n'})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-vb",metastring:'title="Set visible attribute of tab control based on the MySelectedTabTag"',children:"Sub ShowTab(control As IRibbonControl, ByRef visible)\n\n    If control.Tag Like MySelectedTabTag Then\n        visible = True\n    Else\n        visible = False\n    End If\n\nEnd Sub\n"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-xml",metastring:'title="Generate visible attribute of group control, dynamically"',children:'\x3c!-- XML --\x3e\n<group id="tb1gp3" \n    tag="tb1gp3" \n    label="Group 3" \n    getVisible="ShowGroup">\n'})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-vb",metastring:'title="Set visible attribute of group control based on the MySelectedGroupTag"',children:"Sub ShowGroup(control As IRibbonControl, ByRef visible)\n\n    If control.Tag Like MySelectedGroupTag Then\n        visible = True\n    Else\n        visible = False\n    End If\n\nEnd Sub\n"})}),"\n",(0,o.jsx)(n.h3,{id:"onaction",children:"OnAction"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-xml",metastring:'title="Execute change of tab"',children:'\x3c!-- XML --\x3e\n<button id="tb1gp1mn1_01" \n        label="Show Tab 2" \n        onAction="ChangeTab" \n        imageMso="ControlTabControl" />\n'})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-vb",metastring:'title="Display ribbon tab on demand"',children:'\' =====================================\n\' Tag:="testTab"     Show/Hide only the Tab, Group or Control with Tag "testTab"\n\' Tag:="My*"         Show/Hide every Tab, Group or Control with Tag that starts with "My"\n\' Tag:="*"           Show/Hide every Tab, Group or Control\n\' Tag:=""            Hide every Tab, Group or Control\n\' ======================================\nSub ChangeTab(control As IRibbonControl)\n    \n    Select Case MySelectedTabTag\n        Case "tb1": Call RibbonRefresh(TabTag:="tb2", TabID:="tb2")\n        Case "tb2": Call RibbonRefresh(TabTag:="tb1", TabID:="tb1")\n    End Select\n\nEnd Sub\n'})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-xml",metastring:'title="Execute change of group"',children:'\x3c!-- XML --\x3e\n<button id="tb1gp1mn1_02" \n        getLabel="LabelNextGroup"\n        onAction="ChangeGroup"\n        imageMso="FormControlGroupBox" />\n'})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-vb",metastring:'title="Display tab group on demand"',children:'Sub ChangeGroup(control As IRibbonControl)\n\n    Select Case MySelectedGroupTag\n        Case "tb1gp2": Call RibbonRefresh(TabTag:=MySelectedTabTag, GroupTag:="tb1gp3")\n        Case "tb1gp3": Call RibbonRefresh(TabTag:=MySelectedTabTag, GroupTag:="tb1gp2")\n    End Select\n    \nEnd Sub\n'})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-vb",metastring:'title="Refresh the ribbon"',children:'Sub RibbonRefresh(TabTag As String, Optional TabID As String, Optional GroupTag As String)\n\n    Application.ScreenUpdating = False\n\n    MySelectedTabTag = TabTag\n    If GroupTag <> "" Then\n        MySelectedGroupTag = GroupTag\n    End If\n    \n    If Ribbon Is Nothing Then\n        MsgBox "Error, Save/Restart your workbook"\n    Else\n        Ribbon.Invalidate\n        If TabID <> "" Then Ribbon.ActivateTab TabID\n    End If\n\n    Application.ScreenUpdating = True\n    \nEnd Sub\n'})}),"\n",(0,o.jsx)(n.h3,{id:"getselecteditemid",children:"GetSelectedItemID"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-xml",metastring:'title="Generate the default selected item of a dropdown control, dynamically"',children:'<dropDown id="tb2gp2dd1" \n        label="Dropdown 1" \n        sizeString="WWWWWWWWWWW" \n        getSelectedItemID="GetDefaultItemID" \n        onAction="GetSelectedItemID">\n'})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-vb",metastring:'title="Get default item to display by ID"',children:"Sub GetDefaultItemID(ByRef control As IRibbonControl, ByRef returnedVal As Variant)\n\n    returnedVal = MySelectedItemID\n    \nEnd Sub\n"})}),"\n",(0,o.jsx)(n.h3,{id:"getlabel",children:"GetLabel"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-xml",metastring:'title="Generate label attribute of control, dynamically"',children:'\x3c!-- XML --\x3e\n<button id="tb1gp1mn1_02" \n        getLabel="LabelNextGroup"\n        onAction="ChangeGroup"\n        imageMso="FormControlGroupBox" />\n'})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-vb",metastring:'title="Generate button label based on the opposite state to MySelectedGroupTag"',children:'Sub LabelNextGroup(control As IRibbonControl, ByRef returnedVal)\n\n    Select Case MySelectedGroupTag\n        Case "tb1gp2": returnedVal = "Group 3"\n        Case "tb1gp3": returnedVal = "Group 2"\n    End Select\n\nEnd Sub\n'})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-vb",metastring:'title="Get user selected item by ID"',children:"Sub GetSelectedItemID(control As IRibbonControl, ID As String, index As Integer)\n\n    MySelectedItemID = ID\n\nEnd Sub\n"})}),"\n",(0,o.jsx)(n.h2,{id:"gallery",children:"Gallery"}),"\n",(0,o.jsx)("img",{src:"/msexcel/img/img-mso-CharacterBorder.png",alt:"CharacterBorder",title:"CharacterBorder"}),"\n",(0,o.jsx)("img",{src:"/msexcel/img/img-mso-CharacterShading.png",alt:"CharacterShading",title:"CharacterShading"}),"\n",(0,o.jsx)("img",{src:"/msexcel/img/img-mso-CombineShapesGallery.png",alt:"CombineShapesGallery",title:"CombineShapesGallery"}),"\n",(0,o.jsx)("img",{src:"/msexcel/img/img-mso-CreateMacro.png",alt:"CreateMacro",title:"CreateMacro"}),"\n",(0,o.jsx)("img",{src:"/msexcel/img/img-mso-BlogManageAccounts.png",alt:"BlogManageAccounts",title:"BlogManageAccounts"}),"\n",(0,o.jsx)("img",{src:"/msexcel/img/img-mso-Clear.png",alt:"Clear",title:"Clear"}),"\n",(0,o.jsx)("img",{src:"/msexcel/img/img-mso-AutoFilterClassic.png",alt:"AutoFilterClassic",title:"AutoFilterClassic"}),"\n",(0,o.jsx)("img",{src:"/msexcel/img/img-mso-AudioNoteDelete.png",alt:"AudioNoteDelete",title:"AudioNoteDelete"}),"\n",(0,o.jsx)("img",{src:"/msexcel/img/img-mso-ApproveApprovalRequest.png",alt:"ApproveApprovalRequest",title:"ApproveApprovalRequest"}),"\n",(0,o.jsx)("img",{src:"/msexcel/img/img-mso-ChangeToDeclineInvitation.png",alt:"ChangeToDeclineInvitation",title:"ChangeToDeclineInvitation"}),"\n",(0,o.jsx)("img",{src:"/msexcel/img/img-mso-AutoFormat.png",alt:"AutoFormat",title:"AutoFormat"}),"\n",(0,o.jsx)("img",{src:"/msexcel/img/img-mso-CustomEquationsGallery.png",alt:"CustomEquationsGallery",title:"CustomEquationsGallery"}),"\n",(0,o.jsx)("img",{src:"/msexcel/img/img-mso-AlignLeft.png",alt:"AlignLeft",title:"AlignLeft"}),"\n",(0,o.jsx)("img",{src:"/msexcel/img/img-mso-AppointmentColor0.png",alt:"AppointmentColor0",title:"AppointmentColor0"}),"\n",(0,o.jsx)("img",{src:"/msexcel/img/img-mso-AppointmentColor1.png",alt:"AppointmentColor1",title:"AppointmentColor1"}),"\n",(0,o.jsx)("img",{src:"/msexcel/img/img-mso-AppointmentColor2.png",alt:"AppointmentColor2",title:"AppointmentColor2"}),"\n",(0,o.jsx)("img",{src:"/msexcel/img/img-mso-AppointmentColor3.png",alt:"AppointmentColor3",title:"AppointmentColor3"}),"\n",(0,o.jsx)("img",{src:"/msexcel/img/img-mso-AppointmentColor4.png",alt:"AppointmentColor4",title:"AppointmentColor4"}),"\n",(0,o.jsx)("img",{src:"/msexcel/img/img-mso-AppointmentColor5.png",alt:"AppointmentColor5",title:"AppointmentColor5"}),"\n",(0,o.jsx)("img",{src:"/msexcel/img/img-mso-AppointmentColor6.png",alt:"AppointmentColor6",title:"AppointmentColor6"}),"\n",(0,o.jsx)("img",{src:"/msexcel/img/img-mso-AppointmentColor7.png",alt:"AppointmentColor7",title:"AppointmentColor7"}),"\n",(0,o.jsx)("img",{src:"/msexcel/img/img-mso-AppointmentColor8.png",alt:"AppointmentColor8",title:"AppointmentColor8"}),"\n",(0,o.jsx)("img",{src:"/msexcel/img/img-mso-AppointmentColor9.png",alt:"AppointmentColor9",title:"AppointmentColor9"}),"\n",(0,o.jsx)("img",{src:"/msexcel/img/img-mso-AppointmentColor10.png",alt:"AppointmentColor9",title:"AppointmentColor10"}),"\n",(0,o.jsx)("img",{src:"/msexcel/img/img-mso-BlackAndWhiteBlack.png",alt:"BlackAndWhiteBlack",title:"BlackAndWhiteBlack"}),"\n",(0,o.jsx)("img",{src:"/msexcel/img/img-mso-BlackAndWhiteAutomatic.png",alt:"BlackAndWhiteAutomatic",title:"BlackAndWhiteAutomatic"}),"\n",(0,o.jsx)("img",{src:"/msexcel/img/img-mso-BlackAndWhite.png",alt:"BlackAndWhite",title:"BlackAndWhite"}),"\n",(0,o.jsx)("img",{src:"/msexcel/img/img-mso-BlackAndWhiteGrayWithWhiteFill.png",alt:"BlackAndWhiteGrayWithWhiteFill",title:"BlackAndWhiteGrayWithWhiteFill"}),"\n",(0,o.jsx)("img",{src:"/msexcel/img/img-mso-BlackAndWhiteInverseGrayscale.png",alt:"BlackAndWhiteInverseGrayscale",title:"BlackAndWhiteInverseGrayscale"}),"\n",(0,o.jsx)("img",{src:"/msexcel/img/img-mso-ArrangeByLogContact.png",alt:"ArrangeByLogContact",title:"ArrangeByLogContact"}),"\n",(0,o.jsx)("img",{src:"/msexcel/img/img-mso-AnimationStartDropdown.png",alt:"AnimationStartDropdown",title:"AnimationStartDropdown"}),"\n",(0,o.jsx)("img",{src:"/msexcel/img/img-mso-BlogHomePage.png",alt:"BlogHomePage",title:"BlogHomePage"}),"\n",(0,o.jsx)("img",{src:"/msexcel/img/img-mso-BlogCategoriesRefresh.png",alt:"BlogCategoriesRefresh",title:"BlogCategoriesRefresh"}),"\n",(0,o.jsx)("img",{src:"/msexcel/img/img-mso-Chart3DColumnChart.png",alt:"Chart3DColumnChart",title:"Chart3DColumnChart"}),"\n",(0,o.jsx)(n.hr,{}),"\n",(0,o.jsx)("img",{src:"/msexcel/img/img-mso-ContactCardCallOther.png",alt:"ContactCardCallOther",title:"ContactCardCallOther"}),"\n",(0,o.jsx)("img",{src:"/msexcel/img/img-mso-ChartInsert.png",alt:"ChartInsert",title:"ChartInsert"}),"\n",(0,o.jsx)("img",{src:"/msexcel/img/img-mso-ChartAreaChart.png",alt:"ChartAreaChart",title:"ChartAreaChart"}),"\n",(0,o.jsx)("img",{src:"/msexcel/img/img-mso-Chart3DConeChart.png",alt:"Chart3DConeChart",title:"Chart3DConeChart"}),"\n",(0,o.jsx)("img",{src:"/msexcel/img/img-mso-Chart3DBarChart.png",alt:"Chart3DBarChart",title:"Chart3DBarChart"}),"\n",(0,o.jsx)(n.hr,{}),"\n",(0,o.jsx)(n.h2,{id:"resources",children:"Resources"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.a,{href:"https://bert-toolkit.com/imagemso-list.html",children:"ImageMSO Gallery"})}),"\n"]})]})}function g(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(m,{...e})}):m(e)}},7631:(e,n,t)=>{t.d(n,{A:()=>i});const i=t.p+"assets/images/img-commonaddin-tabmain-13fa98c2ac48f85b69327c16c37173a3.png"},8453:(e,n,t)=>{t.d(n,{R:()=>a,x:()=>s});var i=t(6540);const o={},l=i.createContext(o);function a(e){const n=i.useContext(l);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:a(e.components),i.createElement(l.Provider,{value:n},e.children)}}}]);