"use strict";(self.webpackChunkdocusaurus_site=self.webpackChunkdocusaurus_site||[]).push([[132],{856:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>r,contentTitle:()=>s,default:()=>b,frontMatter:()=>a,metadata:()=>l,toc:()=>c});const l=JSON.parse('{"id":"customuiribbon","title":"CustomUI Ribbon Template","description":"CustomUI Ribbon Template provides a simple starting point to implement customised Excel ribbon.","source":"@site/docs/customuiribbon.md","sourceDirName":".","slug":"/customuiribbon","permalink":"/msexcel/customuiribbon","draft":false,"unlisted":false,"editUrl":"https://github.com/therepos/msexcel/edit/main/docs/customuiribbon.md","tags":[],"version":"current","lastUpdatedAt":1748938443000,"frontMatter":{},"sidebar":"docSidebar","previous":{"title":"Common Excel Addin","permalink":"/msexcel/commonaddin"}}');var o=t(4848),i=t(8453);const a={},s="CustomUI Ribbon Template",r={},c=[{value:"Documentation",id:"documentation",level:2},{value:"OnLoad",id:"onload",level:3},{value:"GetVisible",id:"getvisible",level:3},{value:"OnAction",id:"onaction",level:3},{value:"GetSelectedItemID",id:"getselecteditemid",level:3},{value:"GetLabel",id:"getlabel",level:3},{value:"Examples",id:"examples",level:3}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",img:"img",li:"li",p:"p",pre:"pre",ul:"ul",...(0,i.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.header,{children:(0,o.jsx)(n.h1,{id:"customui-ribbon-template",children:"CustomUI Ribbon Template"})}),"\n",(0,o.jsx)(n.p,{children:"CustomUI Ribbon Template provides a simple starting point to implement customised Excel ribbon."}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["Download ",(0,o.jsx)(n.a,{href:"https://github.com/therepos/msexcel/blob/main/temp/bas/customuiribbon-t100.xlam",children:"CustomUI Ribbon Template v1.0.0"}),"."]}),"\n",(0,o.jsxs)(n.li,{children:["Read/Write embedded XML file with ",(0,o.jsx)(n.a,{href:"https://github.com/fernandreu/office-ribbonx-editor",children:"Office RibbonX Editor"}),"."]}),"\n",(0,o.jsxs)(n.li,{children:["Microsoft Excel add-ins ",(0,o.jsx)(n.a,{href:"https://docs.microsoft.com/en-us/office/dev/add-ins/excel/excel-add-ins-overview",children:"documentation"}),"."]}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"documentation",children:"Documentation"}),"\n",(0,o.jsx)(n.h3,{id:"onload",children:"OnLoad"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsx)(n.p,{children:"Initialise state of controls on load."}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-xml",children:'\x3c!-- XML --\x3e\n<customUI xmlns="http://schemas.microsoft.com/office/2009/07/customui" \n          onLoad="RibbonOnLoad">\n'})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-vb",children:"' VBA\n' Declare global variables and object\nPublic Ribbon As IRibbonUI\nPublic MySelectedTabTag As String\nPublic MySelectedGroupTag As String\nPublic MySelectedItemID As String\n"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-vb",children:'\' VBA\n\' Initialise the ribbon\nSub RibbonOnLoad(Rib As IRibbonUI)\n\n    Set Ribbon = Rib\n    MySelectedTabTag = "tb1"\n    MySelectedGroupTag = "tb1gp2"\n    MySelectedItemID = "tb2gp2dd1_01"\n    \nEnd Sub\n'})}),"\n"]}),"\n"]}),"\n",(0,o.jsx)(n.h3,{id:"getvisible",children:"GetVisible"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsx)(n.p,{children:"Generate visible attribute of tab control, dynamically."}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-xml",children:'\x3c!-- XML --\x3e\n<tab id="tb1" \n    tag="tb1" \n    label="Tab 1" \n    getVisible="ShowTab">\n'})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-vb",children:"' VBA\n' Set visible attribute of tab control based on the MySelectedTabTag\nSub ShowTab(control As IRibbonControl, ByRef visible)\n\n    If control.Tag Like MySelectedTabTag Then\n        visible = True\n    Else\n        visible = False\n    End If\n\nEnd Sub\n"})}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsx)(n.p,{children:"Generate visible attribute of group control, dynamically."}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-xml",children:'\x3c!-- XML --\x3e\n<group id="tb1gp3" \n    tag="tb1gp3" \n    label="Group 3" \n    getVisible="ShowGroup">\n'})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-vb",children:"' VBA\n' Set visible attribute of group control based on the MySelectedGroupTag\nSub ShowGroup(control As IRibbonControl, ByRef visible)\n\n    If control.Tag Like MySelectedGroupTag Then\n        visible = True\n    Else\n        visible = False\n    End If\n\nEnd Sub\n"})}),"\n"]}),"\n"]}),"\n",(0,o.jsx)(n.h3,{id:"onaction",children:"OnAction"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsx)(n.p,{children:"Execute change of tab."}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-xml",children:'\x3c!-- XML --\x3e\n<button id="tb1gp1mn1_01" \n        label="Show Tab 2" \n        onAction="ChangeTab" \n        imageMso="ControlTabControl" />\n'})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-vb",children:'\' VBA\n\' Display ribbon tab on demand\n\' =====================================\n\' Tag:="testTab"     Show/Hide only the Tab, Group or Control with Tag "testTab"\n\' Tag:="My*"         Show/Hide every Tab, Group or Control with Tag that starts with "My"\n\' Tag:="*"           Show/Hide every Tab, Group or Control\n\' Tag:=""            Hide every Tab, Group or Control\n\' ======================================\nSub ChangeTab(control As IRibbonControl)\n    \n    Select Case MySelectedTabTag\n        Case "tb1": Call RibbonRefresh(TabTag:="tb2", TabID:="tb2")\n        Case "tb2": Call RibbonRefresh(TabTag:="tb1", TabID:="tb1")\n    End Select\n\nEnd Sub\n'})}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsx)(n.p,{children:"Execute change of group."}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-xml",children:'\x3c!-- XML --\x3e\n<button id="tb1gp1mn1_02" \n        getLabel="LabelNextGroup"\n        onAction="ChangeGroup"\n        imageMso="FormControlGroupBox" />\n'})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-vb",children:'\' VBA\n\' Display tab group on demand\nSub ChangeGroup(control As IRibbonControl)\n\n    Select Case MySelectedGroupTag\n        Case "tb1gp2": Call RibbonRefresh(TabTag:=MySelectedTabTag, GroupTag:="tb1gp3")\n        Case "tb1gp3": Call RibbonRefresh(TabTag:=MySelectedTabTag, GroupTag:="tb1gp2")\n    End Select\n    \nEnd Sub\n'})}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsx)(n.p,{children:"Support function to reload ribbon after initial load."}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-vb",children:'\' VBA\n\' Refresh the ribbon\nSub RibbonRefresh(TabTag As String, Optional TabID As String, Optional GroupTag As String)\n\n    Application.ScreenUpdating = False\n\n    MySelectedTabTag = TabTag\n    If GroupTag <> "" Then\n        MySelectedGroupTag = GroupTag\n    End If\n    \n    If Ribbon Is Nothing Then\n        MsgBox "Error, Save/Restart your workbook"\n    Else\n        Ribbon.Invalidate\n        If TabID <> "" Then Ribbon.ActivateTab TabID\n    End If\n\n    Application.ScreenUpdating = True\n    \nEnd Sub\n'})}),"\n"]}),"\n"]}),"\n",(0,o.jsx)(n.h3,{id:"getselecteditemid",children:"GetSelectedItemID"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsx)(n.p,{children:"Generate the default selected item of a dropdown control, dynamically."}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-xml",children:'\x3c!-- XML --\x3e\n<dropDown id="tb2gp2dd1" \n        label="Dropdown 1" \n        sizeString="WWWWWWWWWWW" \n        getSelectedItemID="GetDefaultItemID" \n        onAction="GetSelectedItemID">\n'})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-vb",children:"' VBA\n' Get default item to display by ID\nSub GetDefaultItemID(ByRef control As IRibbonControl, ByRef returnedVal As Variant)\n\n    returnedVal = MySelectedItemID\n    \nEnd Sub\n"})}),"\n"]}),"\n"]}),"\n",(0,o.jsx)(n.h3,{id:"getlabel",children:"GetLabel"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsx)(n.p,{children:"Generate label attribute of control, dynamically."}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-xml",children:'\x3c!-- XML --\x3e\n<button id="tb1gp1mn1_02" \n        getLabel="LabelNextGroup"\n        onAction="ChangeGroup"\n        imageMso="FormControlGroupBox" />\n'})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-vb",children:'\' VBA\n\' Generate button label based on the opposite state to MySelectedGroupTag\nSub LabelNextGroup(control As IRibbonControl, ByRef returnedVal)\n\n    Select Case MySelectedGroupTag\n        Case "tb1gp2": returnedVal = "Group 3"\n        Case "tb1gp3": returnedVal = "Group 2"\n    End Select\n\nEnd Sub\n'})}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsx)(n.p,{children:"Get user's choice from dropdown control."}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-vb",children:"' VBA\n' Get user selected item by ID\nSub GetSelectedItemID(control As IRibbonControl, ID As String, index As Integer)\n\n    MySelectedItemID = ID\n\nEnd Sub\n"})}),"\n"]}),"\n"]}),"\n",(0,o.jsx)(n.h3,{id:"examples",children:"Examples"}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.img,{alt:"ExampleB",src:t(8761).A+"",width:"850",height:"450"})})]})}function b(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(d,{...e})}):d(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>a,x:()=>s});var l=t(6540);const o={},i=l.createContext(o);function a(e){const n=l.useContext(i);return l.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:a(e.components),l.createElement(i.Provider,{value:n},e.children)}},8761:(e,n,t)=>{t.d(n,{A:()=>l});const l=t.p+"assets/images/img-customuiribbon-t100-f94f370f016ff7bb157a861756d21bc1.gif"}}]);