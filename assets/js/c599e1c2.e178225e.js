"use strict";(self.webpackChunkdocusaurus_site=self.webpackChunkdocusaurus_site||[]).push([[520],{5960:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>r,contentTitle:()=>s,default:()=>b,frontMatter:()=>o,metadata:()=>a,toc:()=>c});const a=JSON.parse('{"id":"customui","title":"CustomUI","description":"Template","source":"@site/docs/customui.md","sourceDirName":".","slug":"/customui","permalink":"/msexcel/customui","draft":false,"unlisted":false,"editUrl":"https://github.com/therepos/msexcel/edit/main/docs/customui.md","tags":[],"version":"current","lastUpdatedAt":1749754009000,"frontMatter":{},"sidebar":"docSidebar","previous":{"title":"customfunctions","permalink":"/msexcel/customfunctions"}}');var l=t(4848),i=t(8453);const o={},s="CustomUI",r={},c=[{value:"Template",id:"template",level:2},{value:"Documentation",id:"documentation",level:2},{value:"OnLoad",id:"onload",level:3},{value:"GetVisible",id:"getvisible",level:3},{value:"OnAction",id:"onaction",level:3},{value:"GetSelectedItemID",id:"getselecteditemid",level:3},{value:"GetLabel",id:"getlabel",level:3}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",img:"img",li:"li",p:"p",pre:"pre",ul:"ul",...(0,i.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.header,{children:(0,l.jsx)(n.h1,{id:"customui",children:"CustomUI"})}),"\n",(0,l.jsx)(n.h2,{id:"template",children:"Template"}),"\n",(0,l.jsx)(n.p,{children:"CustomUI Ribbon Template provides a simple starting point to implement customised Excel ribbon."}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["Download ",(0,l.jsx)(n.a,{href:"https://github.com/therepos/msexcel/blob/main/apps/customuiribbon-t100.xlam",children:"CustomUI Ribbon Template v1.0.0"})," or ",(0,l.jsx)(n.a,{href:"https://github.com/therepos/msexcel/blob/main/apps/commonaddin-r010.xlam",children:"Common Excel Addin v0.1.0"}),"."]}),"\n",(0,l.jsxs)(n.li,{children:["Read/Write embedded XML file with ",(0,l.jsx)(n.a,{href:"https://github.com/fernandreu/office-ribbonx-editor",children:"Office RibbonX Editor"}),"."]}),"\n",(0,l.jsxs)(n.li,{children:["Microsoft Excel add-ins ",(0,l.jsx)(n.a,{href:"https://docs.microsoft.com/en-us/office/dev/add-ins/excel/excel-add-ins-overview",children:"documentation"}),"."]}),"\n",(0,l.jsxs)(n.li,{children:["Install the downloaded .xlam file. See ",(0,l.jsx)(n.a,{href:"https://support.microsoft.com/en-us/office/add-or-remove-add-ins-in-excel-0af570c4-5cf3-4fa9-9b88-403625a0b460#:~:text=COM%20add%2Din-,Click%20the%20File%20tab%2C%20click%20Options%2C%20and%20then%20click%20the,install%2C%20and%20then%20click%20OK.",children:"how to install add-ins"}),"."]}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.img,{alt:"ExampleB",src:t(8761).A+"",width:"850",height:"450"})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.img,{alt:"Features",src:t(7631).A+"",width:"1391",height:"208"})}),"\n",(0,l.jsx)(n.h2,{id:"documentation",children:"Documentation"}),"\n",(0,l.jsx)(n.h3,{id:"onload",children:"OnLoad"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-xml",metastring:'title="Initialise state of controls on load"',children:'\x3c!-- XML --\x3e\n<customUI xmlns="http://schemas.microsoft.com/office/2009/07/customui" \n            onLoad="RibbonOnLoad">\n'})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-vb",metastring:'title="Declare global variables and object"',children:"Public Ribbon As IRibbonUI\nPublic MySelectedTabTag As String\nPublic MySelectedGroupTag As String\nPublic MySelectedItemID As String\n"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-vb",metastring:'title="Initialise the ribbon"',children:'Sub RibbonOnLoad(Rib As IRibbonUI)\n\n    Set Ribbon = Rib\n    MySelectedTabTag = "tb1"\n    MySelectedGroupTag = "tb1gp2"\n    MySelectedItemID = "tb2gp2dd1_01"\n    \nEnd Sub\n'})}),"\n",(0,l.jsx)(n.h3,{id:"getvisible",children:"GetVisible"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-xml",metastring:'title="Generate visible attribute of tab control, dynamically"',children:'\x3c!-- XML --\x3e\n<tab id="tb1" \n    tag="tb1" \n    label="Tab 1" \n    getVisible="ShowTab">\n'})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-vb",metastring:'title="Set visible attribute of tab control based on the MySelectedTabTag"',children:"Sub ShowTab(control As IRibbonControl, ByRef visible)\n\n    If control.Tag Like MySelectedTabTag Then\n        visible = True\n    Else\n        visible = False\n    End If\n\nEnd Sub\n"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-xml",metastring:'title="Generate visible attribute of group control, dynamically"',children:'\x3c!-- XML --\x3e\n<group id="tb1gp3" \n    tag="tb1gp3" \n    label="Group 3" \n    getVisible="ShowGroup">\n'})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-vb",metastring:'title="Set visible attribute of group control based on the MySelectedGroupTag"',children:"Sub ShowGroup(control As IRibbonControl, ByRef visible)\n\n    If control.Tag Like MySelectedGroupTag Then\n        visible = True\n    Else\n        visible = False\n    End If\n\nEnd Sub\n"})}),"\n",(0,l.jsx)(n.h3,{id:"onaction",children:"OnAction"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-xml",metastring:'title="Execute change of tab"',children:'\x3c!-- XML --\x3e\n<button id="tb1gp1mn1_01" \n        label="Show Tab 2" \n        onAction="ChangeTab" \n        imageMso="ControlTabControl" />\n'})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-vb",metastring:'title="Display ribbon tab on demand"',children:'\' =====================================\n\' Tag:="testTab"     Show/Hide only the Tab, Group or Control with Tag "testTab"\n\' Tag:="My*"         Show/Hide every Tab, Group or Control with Tag that starts with "My"\n\' Tag:="*"           Show/Hide every Tab, Group or Control\n\' Tag:=""            Hide every Tab, Group or Control\n\' ======================================\nSub ChangeTab(control As IRibbonControl)\n    \n    Select Case MySelectedTabTag\n        Case "tb1": Call RibbonRefresh(TabTag:="tb2", TabID:="tb2")\n        Case "tb2": Call RibbonRefresh(TabTag:="tb1", TabID:="tb1")\n    End Select\n\nEnd Sub\n'})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-xml",metastring:'title="Execute change of group"',children:'\x3c!-- XML --\x3e\n<button id="tb1gp1mn1_02" \n        getLabel="LabelNextGroup"\n        onAction="ChangeGroup"\n        imageMso="FormControlGroupBox" />\n'})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-vb",metastring:'title="Display tab group on demand"',children:'Sub ChangeGroup(control As IRibbonControl)\n\n    Select Case MySelectedGroupTag\n        Case "tb1gp2": Call RibbonRefresh(TabTag:=MySelectedTabTag, GroupTag:="tb1gp3")\n        Case "tb1gp3": Call RibbonRefresh(TabTag:=MySelectedTabTag, GroupTag:="tb1gp2")\n    End Select\n    \nEnd Sub\n'})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-vb",metastring:'title="Refresh the ribbon"',children:'Sub RibbonRefresh(TabTag As String, Optional TabID As String, Optional GroupTag As String)\n\n    Application.ScreenUpdating = False\n\n    MySelectedTabTag = TabTag\n    If GroupTag <> "" Then\n        MySelectedGroupTag = GroupTag\n    End If\n    \n    If Ribbon Is Nothing Then\n        MsgBox "Error, Save/Restart your workbook"\n    Else\n        Ribbon.Invalidate\n        If TabID <> "" Then Ribbon.ActivateTab TabID\n    End If\n\n    Application.ScreenUpdating = True\n    \nEnd Sub\n'})}),"\n",(0,l.jsx)(n.h3,{id:"getselecteditemid",children:"GetSelectedItemID"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-xml",metastring:'title="Generate the default selected item of a dropdown control, dynamically"',children:'<dropDown id="tb2gp2dd1" \n        label="Dropdown 1" \n        sizeString="WWWWWWWWWWW" \n        getSelectedItemID="GetDefaultItemID" \n        onAction="GetSelectedItemID">\n'})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-vb",metastring:'title="Get default item to display by ID"',children:"Sub GetDefaultItemID(ByRef control As IRibbonControl, ByRef returnedVal As Variant)\n\n    returnedVal = MySelectedItemID\n    \nEnd Sub\n"})}),"\n",(0,l.jsx)(n.h3,{id:"getlabel",children:"GetLabel"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-xml",metastring:'title="Generate label attribute of control, dynamically"',children:'\x3c!-- XML --\x3e\n<button id="tb1gp1mn1_02" \n        getLabel="LabelNextGroup"\n        onAction="ChangeGroup"\n        imageMso="FormControlGroupBox" />\n'})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-vb",metastring:'title="Generate button label based on the opposite state to MySelectedGroupTag"',children:'Sub LabelNextGroup(control As IRibbonControl, ByRef returnedVal)\n\n    Select Case MySelectedGroupTag\n        Case "tb1gp2": returnedVal = "Group 3"\n        Case "tb1gp3": returnedVal = "Group 2"\n    End Select\n\nEnd Sub\n'})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-vb",metastring:'title="Get user selected item by ID"',children:"Sub GetSelectedItemID(control As IRibbonControl, ID As String, index As Integer)\n\n    MySelectedItemID = ID\n\nEnd Sub\n"})})]})}function b(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(d,{...e})}):d(e)}},7631:(e,n,t)=>{t.d(n,{A:()=>a});const a=t.p+"assets/images/img-commonaddin-tabmain-13fa98c2ac48f85b69327c16c37173a3.png"},8453:(e,n,t)=>{t.d(n,{R:()=>o,x:()=>s});var a=t(6540);const l={},i=a.createContext(l);function o(e){const n=a.useContext(i);return a.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:o(e.components),a.createElement(i.Provider,{value:n},e.children)}},8761:(e,n,t)=>{t.d(n,{A:()=>a});const a=t.p+"assets/images/img-customuiribbon-t100-f94f370f016ff7bb157a861756d21bc1.gif"}}]);